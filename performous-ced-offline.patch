From 338f4b6f290c1c175831f3730830d1f177353245 Mon Sep 17 00:00:00 2001
From: Markus Koschany <apo@debian.org>
Date: Thu, 5 Feb 2026 20:53:57 +0100
Subject: [PATCH] Add CET build directory

---
 CMakeLists.txt      | 3 +++
 game/CMakeLists.txt | 4 +++-
 game/unicode.cc     | 2 +-
 3 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index b3e5e91d17eb..6f61fd5398d7 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -87,6 +87,9 @@ else()
 	message(STATUS "Localization disabled: Gettext tools (msgfmt) missing")
 endif()
 
+include_directories(${CMAKE_CURRENT_SOURCE_DIR}/ced)
+add_subdirectory(ced)
+
 add_subdirectory(data)
 
 add_subdirectory(game)
diff --git a/game/CMakeLists.txt b/game/CMakeLists.txt
index 68303ca74900..8d0f6fb47090 100644
--- a/game/CMakeLists.txt
+++ b/game/CMakeLists.txt
@@ -124,7 +124,7 @@ set(Aubio_REQUIRED_VERSION "0.4.9")
 if (MINGW)
 	target_link_libraries(performous PRIVATE mingw32)
 endif()
-foreach(lib SDL2 PangoCairo LibRSVG LibXML++ AVFormat SWResample SWScale ZLIB JPEG PNG WebP PortAudio Fontconfig GLM Json Ced Aubio)
+foreach(lib SDL2 PangoCairo LibRSVG LibXML++ AVFormat SWResample SWScale ZLIB JPEG PNG WebP PortAudio Fontconfig GLM Json Aubio)
 	find_package(${lib} ${${lib}_REQUIRED_VERSION} REQUIRED)
 	message(STATUS "${lib} includes: ${${lib}_INCLUDE_DIRS}")
 	target_include_directories(performous SYSTEM PRIVATE ${${lib}_INCLUDE_DIRS})
@@ -132,6 +132,8 @@ foreach(lib SDL2 PangoCairo LibRSVG LibXML++ AVFormat SWResample SWScale ZLIB JP
 	add_definitions(${${lib}_DEFINITIONS})
 endforeach(lib)
 
+target_link_libraries(performous PRIVATE ced)
+
 find_package(fmt 8.1 REQUIRED CONFIG)
 # CppRESTSDK and their godforsaken U macro.
 if(fmt_VERSION VERSION_GREATER_EQUAL 9.0.0)
diff --git a/game/unicode.cc b/game/unicode.cc
index 907c4420c4a1..2347b433636d 100644
--- a/game/unicode.cc
+++ b/game/unicode.cc
@@ -9,7 +9,7 @@
 #include <unicode/unistr.h>
 #include <unicode/ustream.h>
 #include <unicode/ubidi.h>
-#include "compact_enc_det/compact_enc_det.h"
+#include "../ced/compact_enc_det/compact_enc_det.h"
 
 std::unique_ptr<icu::RuleBasedCollator> UnicodeUtil::m_searchCollator;
 std::unique_ptr<icu::RuleBasedCollator> UnicodeUtil::m_sortCollator;
-- 
2.52.0

